(()=>{"use strict";var e,t,n,a,s={208:()=>{},207:(e,t,n)=>{n.d(t,{AV:()=>p,Ag:()=>y,BS:()=>w,Bo:()=>m,DT:()=>d,Rn:()=>r,ix:()=>b,oX:()=>c,p6:()=>u,tD:()=>l,yQ:()=>g});const a="http://127.0.0.1:3000",s=`${a}/garage`,i=`${a}/engine`,o=`${a}/winners`,r=async(e,t=7)=>{const n=await fetch(`${s}?_page=${e}&_limit=${t}`);return{items:await n.json(),count:Number(n.headers.get("X-Total-Count"))}},c=async e=>(await fetch(`${s}/${e}`)).json(),d=async e=>(await fetch(`${s}`,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})).json(),l=async e=>(await fetch(`${s}/${e}`,{method:"DELETE"})).json(),m=async(e,t)=>(await fetch(`${s}/${e}`,{method:"PUT",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})).json(),u=async e=>(await fetch(`${i}?id=${e}&status=started`,{method:"PATCH"})).json(),g=async e=>(await fetch(`${i}?id=${e}&status=stopped`,{method:"PATCH"})).json(),y=async e=>{const t=await fetch(`${i}?id=${e}&status=drive`,{method:"PATCH"}).catch();return 200!==t.status?{success:!1}:Object.assign({},await t.json())},b=async({page:e,limit:t=10,sort:n,order:a})=>{const s=await fetch(`${o}?_page=${e}&limit=${t}${((e,t)=>""!==e&&""!==t?`&_sort=${e}&_order=${t}`:"")(n,a)}`),i=await s.json();return{items:await Promise.all(i.map((async e=>Object.assign(Object.assign({},e),{car:await c(e.id)})))),count:s.headers.get("X-Total-Count")}},w=async e=>(await fetch(`${o}/${e}`,{method:"DELETE"})).json(),p=async({id:e,time:t})=>{const n=await(async e=>(await fetch(`${o}/${e}`)).status)(e);if(404===n)await(async e=>(await fetch(o,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})).json())({id:e,wins:1,time:t});else{const n=await(async e=>(await fetch(`${o}/${e}`)).json())(e);await(async(e,t)=>(await fetch(`${o}/${e}`,{method:"PUT",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})).json())(e,{id:e,wins:n.wins+1,time:t<n.time?t:n.time})}}},321:(e,t,n)=>{n.a(e,(async(e,a)=>{try{n.d(t,{Z:()=>l});var s=n(778),i=n(207),o=n(283),r=n(419),c=e([s,o,r]);[s,o,r]=c.then?(await c)():c;let d=null;const l=()=>{document.body.addEventListener("click",(async e=>{const t=e.target;if(t.classList.contains("start-engine-button")){const e=+t.id.split("start-engine-car-")[1];(0,s.Sz)(e)}if(t.classList.contains("stop-engine-button")){const e=+t.id.split("stop-engine-car-")[1];(0,s.sL)(e)}if(t.classList.contains("select-button")&&(d=await(0,i.oX)(Number(t.id.split("select-car-")[1])),document.getElementById("update-name").value=d.name,document.getElementById("update-color").value=d.color,document.getElementById("update-name").disabled=!1,document.getElementById("update-color").disabled=!1,document.getElementById("update-submit").disabled=!1),t.classList.contains("remove-button")){const e=+t.id.split("remove-car-")[1];await(0,i.tD)(e),await(0,i.BS)(e),await(0,s.gO)(),document.getElementById("garage").innerHTML=(0,s.O3)()}if(t.classList.contains("generator-button")){t.disabled=!0;const e=(0,o.cj)();await Promise.all(e.map((e=>(0,i.DT)(e)))),await(0,s.gO)(),document.getElementById("garage").innerHTML=(0,s.O3)(),t.disabled=!1}if(t.classList.contains("race-button")){t.disabled=!0;const e=await(0,o.S3)(s.Sz);await(0,i.AV)(e);const n=document.getElementById("message");n.innerHTML=`${e.name} went first ${e.time}s.`,n.classList.toggle("visible",!0),document.getElementById("reset").disabled=!1}if(t.classList.contains("reset-button")&&(t.disabled=!0,r.Z.cars.map((({id:e})=>(0,s.sL)(e))),document.getElementById("message").classList.toggle("visible",!1),document.getElementById("race").disabled=!1),t.classList.contains("prev-button"))switch(r.Z.view){case"garage":r.Z.carsPage-=1,await(0,s.gO)(),document.getElementById("garage").innerHTML=(0,s.O3)();break;case"winner":r.Z.winnersPage-=1,await(0,s.kD)(),document.getElementById("winners-view").innerHTML=(0,s.V9)()}if(t.classList.contains("next-button"))switch(r.Z.view){case"garage":r.Z.carsPage+=1,await(0,s.gO)(),document.getElementById("garage").innerHTML=(0,s.O3)();break;case"winner":r.Z.winnersPage+=1,await(0,s.kD)(),document.getElementById("winners-view").innerHTML=(0,s.V9)()}t.classList.contains("garage-menu-button")&&(document.getElementById("garage-view").style.display="block",r.Z.view="garage",document.getElementById("winners-view").style.display="none"),t.classList.contains("winners-menu-button")&&(document.getElementById("garage-view").style.display="none",document.getElementById("winners-view").style.display="block",r.Z.view="winner",await(0,s.kD)(),document.getElementById("winners-view").innerHTML=(0,s.V9)()),t.classList.contains("table-wins")&&((0,s.Yr)("wins"),await(0,s.kD)(),document.getElementById("winners-view").innerHTML=(0,s.V9)()),t.classList.contains("table-time")&&((0,s.Yr)("time"),await(0,s.kD)(),document.getElementById("winners-view").innerHTML=(0,s.V9)())})),document.getElementById("create").addEventListener("submit",(async e=>{e.preventDefault();const t=e.target,n=t.querySelector(".input"),a=t.querySelector(".color"),o=new Map;o.set(n.name,n.value),o.set(a.name,a.value);const r=Object.fromEntries(o);await(0,i.DT)(r),await(0,s.gO)(),document.getElementById("garage").innerHTML=(0,s.O3)(),document.getElementById("create-name").value="",t.disabled=!0})),document.getElementById("update").addEventListener("submit",(async e=>{e.preventDefault();const t=e.target,n=t.querySelector(".input"),a=t.querySelector(".color"),o=new Map;o.set(n.name,n.value),o.set(a.name,a.value);const r=Object.fromEntries(o);await(0,i.Bo)(d.id,r),await(0,s.gO)(),document.getElementById("garage").innerHTML=(0,s.O3)(),document.getElementById("update-name").value="",document.getElementById("update-name").disabled=!0,document.getElementById("update-color").disabled=!0,document.getElementById("update-submit").disabled=!0,document.getElementById("update-color").value="#ffffff",d=null}))};a()}catch(e){a(e)}}))},419:(e,t,n)=>{n.a(e,(async(e,a)=>{try{n.d(t,{Z:()=>o});var s=n(207);const{items:e,count:i}=await(0,s.Rn)(1),o={carsPage:1,cars:e,carsCount:i,winnersPage:1,winners:[],winnersCount:0,animation:{},view:"garage",sortBy:"",sortOrder:""};a()}catch(e){a(e)}}),1)},778:(e,t,n)=>{n.a(e,(async(e,a)=>{try{n.d(t,{O3:()=>l,Sz:()=>h,V9:()=>u,Yr:()=>f,gO:()=>b,kD:()=>p,sL:()=>v,sY:()=>g});var s=n(207),i=n(419),o=n(283),r=e([i,o]);[i,o]=r.then?(await r)():r;const c=e=>`\n  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="256" height="256" viewBox="0 0 256 256" xml:space="preserve">\n\n  <defs>\n  </defs>\n  <g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;" transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)" >\n    <path d="M 75.479 36.045 l -7.987 -1.22 l -2.35 -2.574 c -5.599 -6.132 -13.571 -9.649 -21.874 -9.649 h -6.245 c -1.357 0 -2.696 0.107 -4.016 0.296 c -0.022 0.004 -0.044 0.006 -0.066 0.01 c -7.799 1.133 -14.802 5.468 -19.285 12.106 C 5.706 37.913 0 45.358 0 52.952 c 0 3.254 2.647 5.9 5.9 5.9 h 3.451 c 0.969 4.866 5.269 8.545 10.416 8.545 s 9.447 -3.679 10.416 -8.545 h 30.139 c 0.969 4.866 5.27 8.545 10.416 8.545 s 9.446 -3.679 10.415 -8.545 H 84.1 c 3.254 0 5.9 -2.646 5.9 -5.9 C 90 44.441 83.894 37.331 75.479 36.045 z M 43.269 26.602 c 7.065 0 13.848 2.949 18.676 8.094 H 39.464 l -3.267 -8.068 c 0.275 -0.009 0.55 -0.026 0.826 -0.026 H 43.269 z M 32.08 27.118 l 3.068 7.578 H 18.972 C 22.429 30.813 27.018 28.169 32.08 27.118 z M 19.767 63.397 c -3.652 0 -6.623 -2.971 -6.623 -6.622 c 0 -3.652 2.971 -6.623 6.623 -6.623 s 6.623 2.971 6.623 6.623 C 26.39 60.427 23.419 63.397 19.767 63.397 z M 70.738 63.397 c -3.652 0 -6.623 -2.971 -6.623 -6.622 c 0 -3.652 2.971 -6.623 6.623 -6.623 c 3.651 0 6.622 2.971 6.622 6.623 C 77.36 60.427 74.39 63.397 70.738 63.397 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill:${e}; fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round" />\n  </g>\n  </svg>\n`,d=({id:e,name:t,color:n,isEngineStarted:a})=>`\n  <div class="general-buttons">\n  <button class="button select-button" id="select-car-${e}">Select</button>\n  <button class="button remove-button" id="remove-car-${e}">Remove</button>\n  <span class="car-name">${t}</span>\n  </div>\n  <div class="road">\n  <div class="launch-pad">\n    <div class="color-panel">\n      <button class="icon start-engine-button" id="start-engine-car-${e}" ${a?"disabled":""}>Start</button>\n      <button class="icon stop-engine-button" id="stop-engine-car-${e}" ${a?"disabled":""}>Return/stop</button>\n    </div>\n    <div class="car" id="car-${e}">\n      ${c(n)}\n    </div>\n  </div>\n  <div class="flag" id="flag-${e}">&#127937;</div>\n  </div>\n`,l=()=>`\n  <h1>Garage (${i.Z.carsCount})</h1>\n  <h2>Page #${i.Z.carsPage}</h2>\n  <ul class="garage">\n    ${i.Z.cars.map((e=>`\n    <li>${d(e)}</li>\n    `)).join("")}\n  </ul>\n`,m={byWins:"wins",byTime:"time"},u=()=>`\n  <h1>Winner (${i.Z.winnersCount})</h1>\n  <h2>Page #${i.Z.winnersPage}</h2>\n  <table class="table" cellspacing="0" border="0" cellpadding="0">\n    <thead>\n      <th>Number</th>\n      <th>Car</th>\n      <th>Name</th>\n      <th class="table-button table-wins ${i.Z.sortBy===m.byWins?i.Z.sortOrder:""}" id="sort-by-wins">Wins</th>\n      <th class="table-button table-time ${i.Z.sortBy===m.byTime?i.Z.sortOrder:""}" id="sort-by-time">Best time (seconds)</th>\n    </thead>\n    <tbody>\n      ${i.Z.winners.map(((e,t)=>`\n        <tr>\n          <td>${t+1}</td>\n          <td>${c(e.car.color)}</td>\n          <td>${e.car.name}</td>\n          <td>${e.wins}</td>\n          <td>${e.time}</td>\n        </tr>\n      `)).join("")}\n    </tbody>\n  </table>\n`,g=async()=>{const e=`\n    <div class="menu">\n      <button class="button garage-menu-button primary" id="garage-menu">To Garage</button>\n      <button class="button winners-menu-button primary" id="winners-menu">To Winners</button>\n    </div>\n    <div id="garage-view">\n      <div>\n        <form class="form" id="create">\n          <input class="input" id="create-name" name="name" type="text">\n          <input class="color" id="create-color" name="color" type="color" value="#ffffff">\n          <button class="button" type="submit">Create</button>\n        </form>\n        <form class="form" id="update">\n          <input class="input" id="update-name" name="name" type="text" disabled>\n          <input class="color" id="update-color" name="color" type="color" value="#ffffff" disabled>\n          <button class="button" id="update-submit" type="submit">Update</button>\n        </form>\n      </div>\n      <div class="race-controls">\n        <button class="button race-button primary" id="race">Race</button>\n        <button class="button reset-button primary" id="reset">Reset</button>\n        <button class="button generator-button primary" id="generator">Generate Cars</button>\n      </div>\n      <div id="garage">\n        ${l()}\n      </div>\n      <div>\n        <p class="message" id="message"></p>\n      </div>\n    </div>\n    <div id="winners-view" style="display: none;">\n      ${u()}\n    </div>\n    <div class="pagination">\n      <button class="button primary prev-button" id="prev" disabled>Prev</button>\n      <button class="button primary next-button" id="next" disabled>Next</button>\n    </div>\n  `,t=document.createElement("div");t.innerHTML=e,document.body.append(t)},y=7,b=async()=>{const{items:e,count:t}=await(0,s.Rn)(i.Z.carsPage);i.Z.cars=e,i.Z.carsCount=t,i.Z.carsPage*y<Number(i.Z.carsCount)?document.getElementById("next").disabled=!1:document.getElementById("next").disabled=!0,i.Z.carsPage>1?document.getElementById("prev").disabled=!1:document.getElementById("prev").disabled=!0},w=10,p=async()=>{const{items:e,count:t}=await(0,s.ix)({page:i.Z.winnersPage,limit:y,sort:i.Z.sortBy,order:i.Z.sortOrder});i.Z.winners=e,i.Z.winnersCount=Number(t),i.Z.winnersPage*w<Number(i.Z.winnersCount)?document.getElementById("next").disabled=!1:document.getElementById("next").disabled=!0,i.Z.winnersPage>1?document.getElementById("prev").disabled=!1:document.getElementById("prev").disabled=!0},h=async e=>{const t=document.getElementById(`start-engine-car-${e}`);t.disabled=!0,t.classList.toggle("enabling",!0);const{velocity:n,distance:a}=await(0,s.p6)(e),r=Math.round(a/n);t.classList.toggle("enabling",!1),document.getElementById(`stop-engine-car-${e}`).disabled=!1;const c=document.getElementById(`car-${e}`),d=document.getElementById(`flag-${e}`),l=Math.floor((0,o.hG)(c,d))+100;i.Z.animation[e]=(0,o.oQ)(c,l,r);const{success:m}=await(0,s.Ag)(e);return m||window.cancelAnimationFrame(i.Z.animation[e].id),{success:m,id:e,time:r}},v=async e=>{const t=document.getElementById(`stop-engine-car-${e}`);t.disabled=!0,t.classList.toggle("enabling",!0),await(0,s.yQ)(e),t.classList.toggle("enabling",!1),document.getElementById(`start-engine-car-${e}`).disabled=!1,document.getElementById(`car-${e}`).style.transform="translateX(0)",i.Z.animation[e]&&window.cancelAnimationFrame(i.Z.animation[e].id)},f=async e=>{i.Z.sortOrder="asc"===i.Z.sortOrder?"desc":"asc",i.Z.sortBy=e};a()}catch(e){a(e)}}))},283:(e,t,n)=>{n.a(e,(async(e,a)=>{try{n.d(t,{S3:()=>l,cj:()=>b,hG:()=>r,oQ:()=>c});var s=n(419),i=e([s]);function o(e){const{top:t,left:n,width:a,height:s}=e.getBoundingClientRect();return{x:n+a/2,y:t+s/2}}function r(e,t){const n=o(e),a=o(t);return Math.hypot(n.x-a.x,n.y-a.y)}function c(e,t,n){const a={},s=(new Date).getTime();return a.id=window.requestAnimationFrame((function i(){const o=(new Date).getTime(),r=Math.round(o-s)*(t/n);e.style.transform=`translateX(${Math.min(r,t)}px)`,r<t&&(a.id=window.requestAnimationFrame(i))})),a}s=(i.then?(await i)():i)[0];const d=async(e,t)=>{const{success:n,id:a,time:i}=await Promise.race(e);if(!n){const n=t.findIndex((e=>e===a));return e.splice(n,1),t.splice(n,1),e.length<1?null:d(e,t)}return Object.assign(Object.assign({},s.Z.cars.find((e=>e.id===a))),{time:+(i/1e3).toFixed(2)})},l=async e=>{const t=s.Z.cars.map((({id:t})=>e(t)));return await d(t,s.Z.cars.map((e=>e.id)))},m=["Lada","VW","KIA","Geely","Audi","Opel","Ford","Renault","Mercedes","BMW"],u=["Vesta","Polo","Rio","Niva Legend","A6","Vectra","Mondeo","Scenic","E-Class","5-Series"],g=()=>`${m[Math.floor(Math.random()*m.length)]} ${u[Math.floor(Math.random()*u.length)]}`,y=()=>{const e="0123456789ABCDEF";let t="#";for(let n=0;n<6;n+=1)t+=e[Math.floor(Math.random()*e.length)];return t},b=(e=100)=>new Array(e).fill(1).map((e=>({name:g(),color:y()})));a()}catch(w){a(w)}}))},607:(e,t,n)=>{n.a(e,(async(e,t)=>{try{var a=n(778),s=n(321),i=e([a,s]);[a,s]=i.then?(await i)():i,(0,a.sY)(),await(0,a.gO)(),(0,s.Z)(),t()}catch(e){t(e)}}),1)}},i={};function o(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={exports:{}};return s[e](n,n.exports,o),n.exports}e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",n="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",a=e=>{e&&!e.d&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},o.a=(s,i,o)=>{var r;o&&((r=[]).d=1);var c,d,l,m=new Set,u=s.exports,g=new Promise(((e,t)=>{l=t,d=e}));g[t]=u,g[e]=e=>(r&&e(r),m.forEach(e),g.catch((e=>{}))),s.exports=g,i((s=>{var i;c=(s=>s.map((s=>{if(null!==s&&"object"==typeof s){if(s[e])return s;if(s.then){var i=[];i.d=0,s.then((e=>{o[t]=e,a(i)}),(e=>{o[n]=e,a(i)}));var o={};return o[e]=e=>e(i),o}}var r={};return r[e]=e=>{},r[t]=s,r})))(s);var o=()=>c.map((e=>{if(e[n])throw e[n];return e[t]})),d=new Promise((t=>{(i=()=>t(o)).r=0;var n=e=>e!==r&&!m.has(e)&&(m.add(e),e&&!e.d&&(i.r++,e.push(i)));c.map((t=>t[e](n)))}));return i.r?d:o()}),(e=>(e?l(g[n]=e):d(u),a(r)))),r&&(r.d=0)},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o(607),o(208)})();